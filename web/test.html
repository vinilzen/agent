<!DOCTYPE html>
<html>
<head>
	<title>Bootstrap 101 Template</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link href="/css/bootstrap.css" rel="stylesheet">
	<link href="/css/bootstrap-responsive.css" rel="stylesheet">
</head>
<body>
<div class="container-fluid">
	<div class="row-fluid">
		<div class="span12">

    		<h1>JS Test for API</h1>
	    	<div class="row-fluid">
	  			<div class="span7 ">
	  				<h2>Тестируем API:</h2>
					<div class="accordion" id="accordion2">
						<div class="accordion-group">
							<div class="accordion-heading">
								<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseFranchise">
								Сеть <span class="label label-success">Готово</span>
								</a>
							</div>
							<div id="collapseFranchise" class="accordion-body collapse in">
								<div class="accordion-inner">

									<ul class="nav nav-tabs" id="myTab">
										<li class="active"><a href="#list_franchise">GET LIST</a></li>
										<li><a href="#show_one_franchise">SHOW ONE</a></li>
										<li><a href="#create_franchise">CREATE</a></li>
										<li><a href="#update_franchise">UPDATE</a></li>
										<li><a href="#delete_franchise">DELETE</a></li>
									</ul>
									 
									<div class="tab-content">
										<div class="tab-pane active get_list" id="list_franchise">

											<form class="form-horizontal">
  												<div class="control-group">
													<label class="control-label">URL:</label>
													<div class="controls">
														<input type="text" class="url" disabled="disabled" value="/franchise" />
													</div>
												</div>


  												<div class="control-group">
													<label class="control-label">METHOD:</label>
													<div class="controls">
														<input type="text" class="method" disabled="disabled" value="GET" />
													</div>
												</div>


												<div class="control-group">
													<div class="controls">
														<span class="btn send" data-section="list_franchise">Выполнить</span>
													</div>
												</div>
											</form>
										</div>
										<div class="tab-pane show_one" id="show_one_franchise">

											<form class="form-horizontal">
  												<div class="control-group">
													<label class="control-label">URL:</label>
													<div class="controls">
														<input type="text" class="url" disabled="disabled" value="/franchise/1" />
													</div>
												</div>

  												<div class="control-group">
													<label class="control-label">METHOD:</label>
													<div class="controls">
														<input type="text" class="method" disabled="disabled" value="GET" />
													</div>
												</div>

  												<div class="control-group">
													<label class="control-label">ID:</label>
													<div class="controls">
														<input type="text" class="franchise_id" value="1" />
													</div>
												</div>

												<div class="control-group">
													<div class="controls">
														<span class="btn send" data-section="show_one_franchise">Выполнить</span>
													</div>
												</div>
											</form>
										</div>
										<div class="tab-pane create" id="create_franchise">
											<form class="form-horizontal">
  												<div class="control-group">
													<label class="control-label">URL:</label>
													<div class="controls">
														<input type="text" class="url" disabled="disabled" value="/franchise/" />
													</div>
												</div>

  												<div class="control-group">
													<label class="control-label">METHOD:</label>
													<div class="controls">
														<input type="text" class="method" disabled="disabled" value="POST" />
													</div>
												</div>

  												<div class="control-group">
													<label class="control-label">Лого:</label>
													<div class="controls">
														<input type="text" name="franchise[logo]" required="required" maxlength="100" class="logo param" />
													</div>
												</div>

  												<div class="control-group">
													<label class="control-label">Бренд*:</label>
													<div class="controls">
														<input type="text" name="franchise[brand]" required="required" maxlength="100" class="brand param" />
													</div>
												</div>
													
												<div class="control-group">
													<label class="control-label">Индустрия*:</label>
													<div class="controls">
														<input type="text" name="franchise[industry]" required="required" maxlength="100" class="industry param" />
													</div>
												</div>

												<div class="control-group">
													<div class="controls">
														<span class="btn send" data-section="create_franchise">Выполнить</span>
													</div>
												</div>
											</form>
										</div>
										<div class="tab-pane update" id="update_franchise">
											<form class="form-horizontal">
  												<div class="control-group">
													<label class="control-label">URL:</label>
													<div class="controls">
														<input type="text" class="url" disabled="disabled" value="/franchise/1" />
													</div>
												</div>

  												<div class="control-group">
													<label class="control-label">METHOD:</label>
													<div class="controls">
														<input type="text" class="method" disabled="disabled" value="PUT" />
													</div>
												</div>

  												<div class="control-group">
													<label class="control-label">ID:</label>
													<div class="controls">
														<input type="text" class="id" name="id" value="1" />
													</div>
												</div>

  												<div class="control-group">
													<label class="control-label">Лого:</label>
													<div class="controls">
														<input type="text" name="franchise[logo]" required="required" maxlength="100" class="param" />
													</div>
												</div>

  												<div class="control-group">
													<label class="control-label">Бренд*:</label>
													<div class="controls">
														<input type="text" name="franchise[brand]" required="required" maxlength="100" class="param" />
													</div>
												</div>
													
												<div class="control-group">
													<label class="control-label">Индустрия*:</label>
													<div class="controls">
														<input type="text" name="franchise[industry]" required="required" maxlength="100" class="param" />
													</div>
												</div>

												<div class="control-group">
													<div class="controls">
														<span class="btn send" data-section="update_franchise">Выполнить</span>
													</div>
												</div>
											</form>
										</div>
										<div class="tab-pane delete" id="delete_franchise">
											<form class="form-horizontal">
												<div class="control-group">
													<label class="control-label">URL:</label>
													<div class="controls">
														<input type="text" class="url" disabled="disabled" id="show_one_franchise" value="/franchise/1" />
	  												</div>
	  											</div>

												<div class="control-group">
													<label class="control-label">METHOD:</label>
													<div class="controls">
														<input type="text" class="method" disabled="disabled" value="DELETE" />
													</div>
												</div>

												<div class="control-group">
													<label class="control-label">ID:</label>
													<div class="controls">
														<input type="text" id="franchise_id" class="id" value="1" />
													</div>
												</div>

												<div class="control-group">
													<div class="controls">
														<span class="btn send" data-section="delete_franchise">Выполнить</span>
													</div>
												</div>
											</form>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="accordion-group">
							<div class="accordion-heading">
								<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapsePoint">
								Точки <span class="label label-warning">В процессе</span> <span class="label label-success">Готово только GET NEAR POINTS</span>
								</a>
							</div>
							<div id="collapsePoint" class="accordion-body collapse">
								<div class="accordion-inner">

									<ul class="nav nav-tabs" id="myTab">
										<li class="active"><a href="#get_points">GET LIST</a></li>
										<li><a href="#get_near_points">GET NEAR POINTS</a></li>
										<li><a href="#show_one_point">SHOW ONE</a></li>
										<li><a href="#create_point">CREATE</a></li>
										<li><a href="#update_point">UPDATE</a></li>
										<li><a href="#delete_point">DELETE</a></li>
									</ul>
									 
									<div class="tab-content">
										<div class="tab-pane active get_list" id="get_points">
											<label>URL</label>
											<input type="text" class="url" value="/point" />
											<span class="btn btn-block send">Выполнить</span>
										</div>
										<div class="tab-pane get_near_points" id="get_near_points">

											
											<form class="form-horizontal">

  												<div class="control-group">
  													<div class="controls">
  														<p>для теста мы на станции метро Белорусская</p>
  													</div>
  												</div>

  												<div class="control-group">
													<label class="control-label">Посмотреть на карте:</label>
													<div class="controls">
														<a href="http://maps.yandex.ru/?text=55.776692,37.585857" class="btn" target="_blank">http://maps.yandex.ru/?text=55.776692,37.585857</a>
													</div>
												</div>

  												<div class="control-group">
													<label class="control-label">URL:</label>
													<div class="controls">
														<input type="text" class="url input-xlarge" disabled="disabled" value="/point/55.776692x37.585857/1000" />
													</div>
												</div>

  												<div class="control-group">
													<label class="control-label">METHOD:</label>
													<div class="controls">
														<input type="text" class="method" disabled="disabled" value="GET" />
													</div>
												</div>

  												<div class="control-group">
													<label class="control-label">Широта x Долгота:</label>
													<div class="controls">
														<input type="text" class="latitude_point input-small" value="55.776692" /> x
														<input type="text" class="longitude_point input-small" value="37.585857" />
													</div>
												</div>

  												<div class="control-group">
													<label class="control-label">В радиусе:</label>
													<div class="controls">
														<input type="text" class="distance_point" value="1000" />
													</div>
												</div>

												<div class="control-group">
													<div class="controls">
														<span class="btn send" data-section="get_near_points">Выполнить</span>
													</div>
												</div>
											</form>
										</div>
										<div class="tab-pane show_one" id="show_one_point">

											<form class="form-horizontal">
  												<div class="control-group">
													<label class="control-label">URL:</label>
													<div class="controls">
														<input type="text" class="url" disabled="disabled" value="/point/1" />
													</div>
												</div>

  												<div class="control-group">
													<label class="control-label">METHOD:</label>
													<div class="controls">
														<input type="text" class="method" disabled="disabled" value="GET" />
													</div>
												</div>

  												<div class="control-group">
													<label class="control-label">ID:</label>
													<div class="controls">
														<input type="text" class="point_id" value="1" />
													</div>
												</div>

												<div class="control-group">
													<div class="controls">
														<span class="btn send">Выполнить</span>
													</div>
												</div>
											</form>
										</div>
										<div class="tab-pane create" id="create_point">
											<strong>НЕ ГОТОВО</strong>
											<form class="form-horizontal">
  												<div class="control-group">
													<label class="control-label">URL:</label>
													<div class="controls">
														<input type="text" class="url" disabled="disabled" value="/point/" />
													</div>
												</div>

  												<div class="control-group">
													<label class="control-label">METHOD:</label>
													<div class="controls">
														<input type="text" class="method" disabled="disabled" value="POST" />
													</div>
												</div>

  												<div class="control-group">
													<label class="control-label">Название*:</label>
													<div class="controls">
														<input type="text" name="franchise[title]" required="required" maxlength="100" class="latitude param" />
													</div>
												</div>

  												<div class="control-group">
													<label class="control-label">Описание(время работы)*:</label>
													<div class="controls">
														<textarea name="franchise[description]" required="required" class="description param"></textarea>
													</div>
												</div>

  												<div class="control-group">
													<label class="control-label">Широта*:</label>
													<div class="controls">
														<input type="text" name="franchise[latitude]" required="required" maxlength="100" class="latitude param" />
													</div>
												</div>
													
												<div class="control-group">
													<label class="control-label">Долгота*:</label>
													<div class="controls">
														<input type="text" name="franchise[longitude]" required="required" maxlength="100" class="longitude param" />
													</div>
												</div>

												<div class="control-group">
													<div class="controls">
														<span class="btn send" data-section="create_point">Выполнить</span>
													</div>
												</div>
											</form>
										</div>
										<div class="tab-pane update" id="update_point">
											<form class="form-horizontal">
  												<div class="control-group">
													<label class="control-label">URL:</label>
													<div class="controls">
														<input type="text" class="url" disabled="disabled" value="/franchise/" />
													</div>
												</div>

  												<div class="control-group">
													<label class="control-label">METHOD:</label>
													<div class="controls">
														<input type="text" class="method" disabled="disabled" value="PUT" />
													</div>
												</div>

  												<div class="control-group">
													<label class="control-label">ID:</label>
													<div class="controls">
														<input type="text" class="id" name="id" value="1" />
													</div>
												</div>

  												<div class="control-group">
													<label class="control-label">Бренд*:</label>
													<div class="controls">
														<input type="text" name="brand" required="required" maxlength="100" class=" brand" />
													</div>
												</div>
													
												<div class="control-group">
													<label class="control-label">Индустрия*:</label>
													<div class="controls">
														<input type="text" name="industry" required="required" maxlength="100" class=" industry" />
													</div>
												</div>

												<div class="control-group">
													<div class="controls">
														<span class="btn send_update_franchise">Выполнить</span>
													</div>
												</div>
											</form>
										</div>
										<div class="tab-pane delete" id="delete_point">
											<form class="form-horizontal">
												<div class="control-group">
													<label class="control-label">URL:</label>
													<div class="controls">
														<input type="text" class="url" disabled="disabled" id="show_one_franchise" value="/franchise/1" />
	  												</div>
	  											</div>

												<div class="control-group">
													<label class="control-label">METHOD:</label>
													<div class="controls">
														<input type="text" class="method" disabled="disabled" value="DELETE" />
													</div>
												</div>

												<div class="control-group">
													<label class="control-label">METHOD:</label>
													<div class="controls">
														<input type="text" id="franchise_id" class="id" value="1" />
													</div>
												</div>

												<div class="control-group">
													<div class="controls">
														<span class="btn send_delete_franchise">Выполнить</span>
													</div>
												</div>
											</form>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="accordion-group">
							<div class="accordion-heading">
								<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseMission">
								Задания <span class="label label-important">Не готово</span>
								</a>
							</div>
							<div id="collapseMission" class="accordion-body collapse">
								<div class="accordion-inner">

									<ul class="nav nav-tabs" id="myTab">
										<li class="active"><a href="#get_list">GET LIST</a></li>
										<li><a href="#show_one">SHOW ONE</a></li>
										<li><a href="#create">CREATE</a></li>
										<li><a href="#update">UPDATE</a></li>
										<li><a href="#delete">DELETE</a></li>
									</ul>
									 
									<div class="tab-content">
										<div class="tab-pane active" id="get_list">
											<label>URL</label>
											<input type="text" class="url" value="/mission" />
											<span class="btn send">Выполнить</span>
										</div>
										<div class="tab-pane" id="show_one">
											<label>URL</label>
											<input type="text" class="url" disabled="disabled" id="show_one_mission" value="/mission/1" />
											<input type="text" id="mission_id" value="1" />
											<span class="btn send">Выполнить</span>
										</div>
										<div class="tab-pane" id="create">

										</div>
										<div class="tab-pane" id="update">update</div>
										<div class="tab-pane" id="delete">delete</div>
									</div>
								</div>
							</div>
						</div>
					</div>
	  			</div>
	  			<div class="span5">
	  				<h2>Результат</h2>
	  				<div class="row-fluid thumbnail">

	  					<div class="progress hide progress-striped active"><div class="bar" style="width: 100%;"></div></div>

	  					<h3>Заголовок:</h3>
	  					<p id="status"></p>
	  					<h3>Ответ:</h3>
	  					<pre id="response"></pre>
	  					<a class="btn btn-block clear_result">Очистить</a>
	  				</div>
	  			</div>
	  		</div>
	  	</div>
	</div>
</div>
<script src="/js/jquery.min.js"></script>
<script src="/js/underscore-min.js"></script>
<script src="/js/backbone-min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/bootstrap-tab.js"></script>
<!--<script src="/js/test.js"></script>-->	
<script>
  $(function () {


	$('.franchise_id').bind('change keyup', function() {
		$('#show_one_franchise .url').val('/franchise/'+$(this).val());
	});
	
	$('#update_franchise .id').bind('change keyup', function() {
		$('#update_franchise .url').val('/franchise/'+$(this).val());
	});

	$('#delete_franchise .id').bind('change keyup', function() {
		$('#delete_franchise .url').val('/franchise/'+$(this).val());
	});

	$('#update_franchise .id').bind('change keyup', function() {
		$('#update_franchise .url').val('/franchise/'+$(this).val());
	});

	$('.latitude_point, .longitude_point, .distance_point').bind('change keyup', function() {
		$('#get_near_points .url').val('/point/'
										+parseFloat($('.latitude_point').val())
										+'x'
										+parseFloat($('.longitude_point').val())
										+'/'
										+parseInt($('.distance_point').val())
									);
	});


    $('#myTab a:first').tab('show');
    $('#myTab a').click(function (e) {
		e.preventDefault();
		$(this).tab('show');
	});

    $('.clear_result').click(function(){

		$('.progress').hide();
		$('#status').html('');
		$('#response').html('');
    });

/*
    $('#get_list_franchise .send').click(function(){
		
		$('.progress').show();
		$('#status').html('');
		$('#response').html('');

		$.ajax({
		  type: "GET",
		  url: '/app_dev.php'+$('.active .url').val()
		}).done(function( a,b,c) {
		  console.log( "done: ",a, b,c);
		  $('.progress').hide();
		  $('#status').html(c.status);
		  $('#response').html(c.responseText);
		}).error(function(a,b,c){
		  console.log( "error: ", a, b,c);
		  $('.progress').hide();
		  $('#status').html(a.status);
		  $('#response').html(a.responseText);
		});

    })

	$('.send_create_franchise').click(function(){
		
		$('.progress').show();
		$('#status').html('');
		$('#response').html('');

		$.ajax({
		  type: "POST",
		  url: '/app_dev.php'+$('#create_franchise .url').val(),
		  data: {	'franchise[brand]': $('#create_franchise .brand').val(), 
		  			'franchise[industry]': $('#create_franchise .industry').val(),
		  			'franchise[logo]': $('#create_franchise .logo').val(),
		  		}
		}).done(function( a,b,c) {
		  console.log( "done: ",a, b,c);
		  $('.progress').hide();
		  $('#status').html(c.status);
		  $('#response').html(c.responseText);
		}).error(function(a,b,c){
		  console.log( "error: ", a, b,c);
		  $('.progress').hide();
		  $('#status').html(a.status);
		  $('#response').html(a.responseText);
		});

    });

	$('.send_update_franchise').click(function(){
		
		$('.progress').show();
		$('#status').html('');
		$('#response').html('');

		$.ajax({
		  type: "PUT",
		  url: '/app_dev.php'+$('#update_franchise .url').val(),
		  data: {	'franchise[brand]': $('#update_franchise .brand').val(), 
		  			'franchise[industry]': $('#update_franchise .industry').val(),
		  			'franchise[logo]': $('#update_franchise .logo').val(),
		  		}
		}).done(function( a,b,c) {
		  console.log( "done: ",a, b,c);
		  $('.progress').hide();
		  $('#status').html(c.status);
		  $('#response').html(c.responseText);
		}).error(function(a,b,c){
		  console.log( "error: ", a, b,c);
		  $('.progress').hide();
		  $('#status').html(a.status);
		  $('#response').html(a.responseText);
		});


    });
		
	$('.send_delete_franchise').click(function(){
		
		$('.progress').show();
		$('#status, #response').html('');

		$.ajax({
		  type: "DELETE",
		  url: '/app_dev.php'+$('#delete_franchise .url').val()
		}).done(function( a,b,c) {
		  console.log( "done: ",a, b,c);
		  $('.progress').hide();
		  $('#status').html(c.status);
		  $('#response').html(c.responseText);
		}).error(function(a,b,c){
		  console.log( "error: ", a, b,c);
		  $('.progress').hide();
		  $('#status').html(a.status);
		  $('#response').html(a.responseText);
		});
    });
		
	$('#get_near_points .send').click(function(){
		
		$('.progress').show();
		$('#status, #response').html('');

		$.ajax({
		  type: "GET",
		  url: '/app_dev.php'+$('#get_near_points .url').val()
		}).done(function( a,b,c) {
		  console.log( "done: ",a, b,c);
		  $('.progress').hide();
		  $('#status').html(c.status);
		  $('#response').html(c.responseText);
		}).error(function(a,b,c){
		  console.log( "error: ", a, b,c);
		  $('.progress').hide();
		  $('#status').html(a.status);
		  $('#response').html(a.responseText);
		});
    });
    */
		
	$('.send').click(function(){
		
		var id = $(this).attr('data-section'),
			data = {};

		$('.progress').show();
		$('#status, #response').html('');

		$("#"+id+" .param").each(function() {
		  data[$(this).attr('name')] = $(this).val();
		});

		console.log(data);

		$.ajax({

		  type: $('#'+id+' .method').val(),

		  url: '/app_dev.php'+$('#'+id+' .url').val(),

		  data:data

		}).done(function( a,b,c) {

		  console.log( "done: ",a, b,c);
		  $('.progress').hide();
		  $('#status').html(c.status);
		  $('#response').html(c.responseText);

		}).error(function(a,b,c){

		  console.log( "error: ", a, b,c);
		  $('.progress').hide();
		  $('#status').html(a.status);
		  $('#response').html(a.responseText);

		});
    });



  })
</script>
</body>
</html>